<!DOCTYPE html><html>
        <head>
        <title>wcm2022</title>
        <meta charset="utf-8">
<meta property="head" content="H2">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link href="https://fonts.googleapis.com/css?family=Quicksand:300,400,500,700,900" rel="stylesheet">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/fonts/icomoon/style.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/bootstrap.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/magnific-popup.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/jquery-ui.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/owl.carousel.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/owl.theme.default.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/bootstrap-datepicker.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/fonts/flaticon/font/flaticon.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/aos.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/style.css">
        <link rel="shortcut icon" href="./../cmsimde/static/favicons.png">
        
        <style type='text/css'>
            .site-section {
            background-color: #FFFF;
            padding: 40px 40px;
            }
            body > div > div.dropdown.open {
                display: block;
            }
        </style>
    
        <!-- <script src="./../cmsimde/static/jquery.js"></script> -->
        <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> -->
        <script src="../cmsimde/static/chimper/js/jquery-3.3.1.min.js"></script>
        <link rel="stylesheet" href="./../cmsimde/static/tipuesearch/css/normalize.min.css">
        <script src="./../cmsimde/static/tipuesearch/tipuesearch_set.js"></script>
        <script src="tipuesearch_content.js"></script>
        <link rel="stylesheet" href="./../cmsimde/static/tipuesearch/css/tipuesearch.css">
        <script src="./../cmsimde/static/tipuesearch/tipuesearch.js"></script>
        <!-- for Wink3 -->
        <link rel="stylesheet" type="text/css" href="./../cmsimde/static/winkPlayer.css" />
        <script type="text/javascript" src="./../cmsimde/static/winkPlayer.js"></script>
        <script>
            /* original tipuesearch
            $(document).ready(function() {
                 $('#tipue_search_input').tipuesearch();
            });
            */
            // customed doSearch
            function doSearch() {
                $('#tipue_search_input').tipuesearch({
                    newWindow: true, 
                    minimumLength: 2,
                    wholeWords: false, // for search 中文
                });
            }
            $(document).ready(doSearch);
        </script>
        
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shCore.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushBash.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushDiff.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushJScript.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushJava.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPython.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushSql.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushHaxe.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushXml.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPhp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPowerShell.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushLua.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCpp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCss.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCSharp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushDart.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushRust.js"></script>
<link type="text/css" rel="stylesheet" href="./../cmsimde/static/syntaxhighlighter/css/shCoreDefault.css"/>
<script type="text/javascript">SyntaxHighlighter.all();</script>
<!-- 暫時不用
<script src="./../cmsimde/static/fengari-web.js"></script>
<script type="text/javascript" src="./../cmsimde/static/Cango-13v08-min.js"></script>
<script type="text/javascript" src="./../cmsimde/static/CangoAxes-4v01-min.js"></script>
<script type="text/javascript" src="./../cmsimde/static/gearUtils-05.js"></script>
-->
<!-- for Brython 暫時不用
<script src="https://scrum-3.github.io/web/brython/brython.js"></script>
<script src="https://scrum-3.github.io/web/brython/brython_stdlib.js"></script>
-->
<style>
img.add_border {
    border: 3px solid blue;
}
</style>

</head>
<body>
<div class='container-fluid'><nav>
        
    <div class="site-wrap">

    <div class="site-mobile-menu">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close mt-3">
          <span class="icon-close2 js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div>
    
            <header class="site-navbar py-4 bg-white" role="banner">
              <div class="container-fluid">
                <div class="row align-items-center">
                <h1>wcm2022</h1>
                <div class="pl-4">
                    <form>
                    <input type="text" placeholder="Search" name="q" id="tipue_search_input" pattern=".{2,}" title="At least 2 characters" required>
                    </form>
                </div>
                  <!-- <div class="col-11 col-xl-2">
                    <h1 class="mb-0 site-logo"><a href="index.html" class="text-black h2 mb-0">wcm2022</a></h1> 
                  </div>
                  -->
                  <div class="col-12 col-md-10 d-none d-xl-block">
                    <nav class="site-navigation position-relative text-right" role="navigation">
    <ul class='site-menu js-clone-nav mr-auto d-none d-lg-block'>
                        <li class="active has-children"><a href="index.html">Home</a>
                        <ul class="dropdown">
                            <li><a href="sitemap.html">Site Map</a></li>
                            <li><a href="./../reveal/index.html">reveal</a></li>
                            <li><a href="./../blog/index.html">blog</a></li>
                        </ul>
                      </li>
                     <li class='has-children'><a href='About.html'>About</a><ul class='dropdown'><li><a href='run.html'>run</a></li></ul><li><a href='w13.html'>w13</a><li><a href='midterm.html'>midterm</a><li class='has-children'><a href='w14.html'>w14</a><ul class='dropdown'><li><a href='1a分組名單.html'>1a分組名單</a></li></ul><li class='has-children'><a href='w17.html'>w17</a><ul class='dropdown'><li><a href='程式內容註解.html'>程式內容註解</a></li></ul><li><a href='Tetris線上遊戲報告.html'>Tetris線上遊戲報告</a><li><a href='Tetris 加入計分系統.html'>Tetris 加入計分系統</a><li><a href='Tetris AI.html'>Tetris AI</a><li><a href='Final.html'>Final</a><li><a href='期末任務1.html'>期末任務1</a></li>
                      </ul>
                </nav>
              </div>
              <div class="d-inline-block d-xl-none ml-md-0 mr-auto py-3" style="position: relative; top: 3px;"><a href="#" class="site-menu-toggle js-menu-toggle text-black"><span class="icon-menu h3"></span></a></div>
              </div>

            </div>
          </div>
          
        </header>
    <div id="tipue_search_content">w17 << <a href='w17.html'>Previous</a> <a href='Tetris線上遊戲報告.html'>Next</a> >> Tetris線上遊戲報告<br /><h1>程式內容註解</h1>
<p>#41023120四設一甲呂昕叡</p>
<p>import random #匯入亂數模組<br/># 以下為 Brython 新增<br/>from browser import document as doc<br/>from browser import html<br/>import browser.timer<br/>#分數系統<br/>def update_score(new_score):<br/> score_doc.innerHTML = "Score: " + str(new_score)<br/># 利用 html 建立一個 CANVAS 標註物件, 與變數 canvas 對應<br/>canvas = html.CANVAS(width = 400, height = 500, id="canvas")<br/>brython_div = doc["brython_div"]<br/>brython_div &lt;= canvas<br/>ctx = canvas.getContext("2d")<br/>#方塊顏色表單<br/>colors = [<br/> (0, 0, 0),<br/> (120, 37, 179),<br/> (100, 179, 179),<br/> (80, 34, 22),<br/> (80, 134, 22),<br/> (180, 34, 22),<br/> (180, 34, 122),<br/>]</p>
<p>#建立方塊形狀<br/>class Figure:<br/> x = 0 #在格子裡的X軸<br/> y = 0 #在格子裡的y軸<br/>#方塊形狀表單<br/> figures = [<br/> [[1, 5, 9, 13], [4, 5, 6, 7]],<br/> [[4, 5, 9, 10], [2, 6, 5, 9]],<br/> [[6, 7, 9, 10], [1, 5, 6, 10]],<br/> [[1, 2, 5, 9], [0, 4, 5, 6], [1, 5, 9, 8], [4, 5, 6, 10]],<br/> [[1, 2, 6, 10], [5, 6, 7, 9], [2, 6, 10, 11], [3, 5, 6, 7]],<br/> [[1, 4, 5, 6], [1, 4, 5, 9], [4, 5, 6, 9], [1, 5, 6, 9]],<br/> [[1, 2, 5, 6]],<br/> ]<br/>#建立初始化函數 <br/> def __init__(self, x, y):<br/> self.x = x #建立變量<br/> self.y = y #建立變量<br/> self.type = random.randint(0, len(self.figures) - 1) #建立變量<br/> self.color = random.randint(1, len(colors) - 1) #在顏色表單裡隨意取一個數<br/> self.rotation = 0 #要旋轉一個方塊的時候默認值為零<br/>#建立基本功能<br/> def image(self):<br/> return self.figures[self.type][self.rotation]<br/>#旋轉功能<br/> def rotate(self):<br/> self.rotation = (self.rotation + 1) % len(self.figures[self.type])</p>
<p>#新建另一個類俄羅斯方塊<br/>class Tetris:<br/> level = 2<br/> score = 0 #分數<br/> state = "start" #狀態<br/> field = [] #格子數<br/> height = 0 #高度<br/> width = 0 #寬度<br/> x = 100 #介面外面寬<br/> y = 60 #介面外面長<br/> zoom = 20 #沒一個方塊的格子長寬<br/> figure = None #設方塊初始值<br/>#初始化函數<br/> def __init__(self, height, width):<br/> self.height = height #高度<br/> self.width = width #寬度<br/> self.field = [] #給格子初始化的表單值<br/> self.score = 0 #分數默認值為零<br/> self.state = "start" #賦予狀態<br/> for i in range(height): <br/> new_line = [] #新行<br/> for j in range(width): #每一列都行使相同的操作<br/> # 起始默認時每一個都填入 0<br/> new_line.append(0)<br/> self.field.append(new_line) #放進格子裡面<br/>#新建方塊<br/> def new_figure(self):<br/> self.figure = Figure(3, 0) #一開始就放在橫坐標的3.0的位置</p>
<p>def intersects(self):<br/> intersection = False<br/> for i in range(4):<br/> for j in range(4):<br/> if i * 4 + j in self.figure.image():<br/> # block 到達底部, 左右兩邊界, 或該座標有其他 block<br/> if i + self.figure.y &gt; self.height - 1 or \<br/> j + self.figure.x &gt; self.width - 1 or \<br/> j + self.figure.x &lt; 0 or \<br/> self.field[i + self.figure.y][j + self.figure.x] &gt; 0:<br/> intersection = True<br/> return intersection<br/>#把滿的那一行消除掉<br/> def break_lines(self):<br/> lines = 0<br/> for i in range(1, self.height):<br/> zeros = 0<br/> for j in range(self.width):<br/> if self.field[i][j] == 0:<br/> zeros += 1<br/> if zeros == 0:<br/> lines += 1<br/> for i1 in range(i, 1, -1):<br/> for j in range(self.width):<br/> self.field[i1][j] = self.field[i1 - 1][j]<br/> self.score += lines ** 2<br/> update_score(self.score)<br/>#瞬間往下掉直到碰到其他方塊<br/> def go_space(self):<br/> while not self.intersects():<br/> self.figure.y += 1<br/> self.figure.y -= 1<br/> self.freeze()<br/>#往下掉的功能<br/> def go_down(self):<br/> self.figure.y += 1<br/> if self.intersects(): #是否交互<br/> self.figure.y -= 1<br/> self.freeze()<br/>#檢查每一列有沒有方塊<br/> def freeze(self):<br/> for i in range(4): <br/> for j in range(4):<br/> if i * 4 + j in self.figure.image():<br/> self.field[i + self.figure.y][j + self.figure.x] = self.figure.color<br/> self.break_lines() <br/> self.new_figure()<br/> if self.intersects(): #如果還是交互了就gameover<br/> self.state = "gameover"<br/>#往邊線去走<br/> def go_side(self, dx):<br/> old_x = self.figure.x<br/> self.figure.x += dx<br/> if self.intersects():<br/> self.figure.x = old_x<br/>#旋轉系統<br/> def rotate(self):<br/> old_rotation = self.figure.rotation<br/> self.figure.rotate()<br/> if self.intersects():<br/> self.figure.rotation = old_rotation</p>
<p># Define some colors<br/># from https://stackoverflow.com/questions/3380726/converting-a-rgb-color-tuple-to-a-six-digit-code<br/>BLACK = '#%02x%02x%02x' % (0, 0, 0) #常量<br/>WHITE = '#%02x%02x%02x' % (255, 255, 255) #常量<br/>GRAY = '#%02x%02x%02x' % (128, 128, 128) #常量</p>
<p>done = False<br/>fps = 25 #幀數<br/>game = Tetris(20, 10)<br/>counter = 0 #等級</p>
<p>pressing_down = False<br/>#設定控制按鍵鍵盤R為旋轉方塊左右鍵為控制方塊移動D為直接將方塊往下到底</p>
<p>def key_down(eve):<br/> key = eve.keyCode<br/> #if event.type == pygame.QUIT:<br/> # 32 is pause<br/> if key == 32:<br/> done = True<br/> # 82 is R鍵 to rotate<br/> if key == 82:<br/> game.rotate()<br/> # 40 is down key<br/> if key == 40:<br/> pressing_down = True<br/> # 37 is left key<br/> if key == 37:<br/> game.go_side(-1)<br/> # 39 is right key<br/> if key == 39:<br/> game.go_side(1)<br/> # 68 is d key to move block to bottom<br/> if key == 68:<br/> game.go_space()<br/> # 27 is escape<br/> # reset the game<br/> if key == 27:<br/> game.__init__(20, 10)</p>
<p>def key_up(eve):<br/> key = eve.keyCode<br/> # 40 is down key<br/> if key == 40:<br/> pressing_down = False</p>
<p>#如果還沒結束<br/>def do_game():<br/> global counter<br/> if game.figure is None: #如果遊戲值為空新增一些方塊<br/> game.new_figure()<br/> counter += 1 <br/> if counter &gt; 100000:<br/> counter = 0<br/> if counter % (fps // game.level // 2) == 0 or pressing_down: #隨著等級越來越高難度也越來越大<br/> if game.state == "start":<br/> game.go_down()<br/> #把格子畫在窗口裡面一行一行的畫<br/> for i in range(game.height):<br/> for j in range(game.width):<br/> ctx.fillStyle = WHITE<br/> #ctx.scale(game.zoom, game.zoom)<br/> ctx.fillRect(game.x + game.zoom * j, game.y + game.zoom * i, game.zoom, game.zoom)<br/> if game.field[i][j] &gt; 0:<br/> ctx.fillStyle = '#%02x%02x%02x' % colors[game.field[i][j]]<br/> ctx.fillRect(game.x + game.zoom * j + 1, game.y + game.zoom * i + 1, game.zoom - 2, game.zoom - 1)<br/> ctx.lineWidth = 1<br/> ctx.strokeStyle = GRAY<br/> ctx.beginPath()<br/> ctx.rect(game.x + game.zoom * j, game.y + game.zoom * i, game.zoom, game.zoom)<br/> ctx.stroke()<br/> if game.figure is not None: #如果格子裡面不為0的時候把它畫出來<br/> for i in range(4):<br/> for j in range(4):<br/> p = i * 4 + j<br/> if p in game.figure.image():<br/> ctx.fillStyle = '#%02x%02x%02x' % colors[game.figure.color]<br/> ctx.fillRect(game.x + game.zoom * (j + game.figure.x) + 1,<br/> game.y + game.zoom * (i + game.figure.y) + 1,<br/> game.zoom - 2, game.zoom - 2)<br/>score_doc = html.DIV("score") #字體<br/>score_doc.id = "score" #顯示分數<br/>brython_div &lt;= score_doc</p>
<p>score = 0<br/>doc.addEventListener("keydown", key_down)<br/>doc.addEventListener("keyup", key_up)<br/>browser.timer.set_interval(do_game, fps)</p>
<br />w17 << <a href='w17.html'>Previous</a> <a href='Tetris線上遊戲報告.html'>Next</a> >> Tetris線上遊戲報告</div>
        
    <!-- footer -->
      <div class="container">
        <div class="row pt-3 mx-auto">
            <p>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank" >Colorlib</a>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            </p>
        </div>
      </div>
    <!-- for footer -->
    
        </div> <!-- for site wrap -->
            <!-- <script src="../cmsimde/static/chimper/js/jquery-3.3.1.min.js"></script> -->
            <script src="../cmsimde/static/chimper/js/jquery-migrate-3.0.1.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery-ui.js"></script>
            <script src="../cmsimde/static/chimper/js/popper.min.js"></script>
            <script src="../cmsimde/static/chimper/js/bootstrap.min.js"></script>
            <script src="../cmsimde/static/chimper/js/owl.carousel.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.stellar.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.countdown.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.magnific-popup.min.js"></script>
            <script src="../cmsimde/static/chimper/js/bootstrap-datepicker.min.js"></script>
            <script src="../cmsimde/static/chimper/js/aos.js"></script>
            <!--
            <script src="../cmsimde/static/chimper/js/typed.js"></script>
                    <script>
                    var typed = new Typed('.typed-words', {
                    strings: ["Web Apps"," WordPress"," Mobile Apps"],
                    typeSpeed: 80,
                    backSpeed: 80,
                    backDelay: 4000,
                    startDelay: 1000,
                    loop: true,
                    showCursor: true
                    });
                    </script>
            -->
            <script src="../cmsimde/static/chimper/js/main.js"></script>
        
<!-- 啟用 LaTeX equations 編輯 -->
  <!-- <script>
  MathJax = {
    tex: {inlineMath: [['$', '$'], ['\(', '\)']]}
  };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>-->
    </body></html>
        